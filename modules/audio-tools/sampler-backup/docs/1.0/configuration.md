## Configuration

Default configuration is generated at `~/.audiotools/rsnapshot.conf`:

```conf
#################################################
# rsnapshot.conf - rsnapshot configuration file #
#################################################
# Generated by @oletizi/sampler-backup
#

config_version	1.2

# Backup destination
snapshot_root	/Users/you/.audiotools/backup/

# External programs
cmd_cp		/bin/cp
cmd_rm		/bin/rm
cmd_rsync	/usr/bin/rsync
cmd_ssh		/usr/bin/ssh
cmd_logger	/usr/bin/logger

# Backup intervals and retention
retain		daily	7
retain		weekly	4
retain		monthly	12

# Logging
verbose		2
loglevel	3

# Rsync options
rsync_short_args	-a
rsync_long_args		--delete --numeric-ids --relative --delete-excluded

# Backup points / sources

# S5K Sampler
backup		pi-scsi2.local:/home/orion/images/	pi-scsi2/

# S3K Sampler
backup		s3k.local:/home/orion/images/	s3k/
```

### Configuration Options

#### Retention Policy

Control how many snapshots to keep:

```conf
retain    daily    7     # Keep 7 daily snapshots
retain    weekly   4     # Keep 4 weekly snapshots
retain    monthly  12    # Keep 12 monthly snapshots
```

#### Rsync Options

Customize transfer behavior:

```conf
# Short args (-a = archive mode: recursive, preserve permissions/timestamps)
rsync_short_args    -a

# Long args
rsync_long_args    --delete --numeric-ids --relative --delete-excluded

# SSH arguments (for remote backups)
ssh_args    -p 22 -i ~/.ssh/id_rsa
```

#### Verbosity

Control logging detail:

```conf
verbose     2    # 1-5, higher = more verbose
loglevel    3    # 1-5, syslog level
```

### Customizing Backup Sources

#### Using the API

```typescript
import { getDefaultRsnapshotConfig, writeRsnapshotConfig } from '@oletizi/sampler-backup';

const config = getDefaultRsnapshotConfig();

// Add S3000XL sampler
config.samplers.push({
    type: "s3k",
    host: "s3000xl.local",
    sourcePath: "/home/pi/images/",
    backupSubdir: "s3000xl"
});

// Add local media (SD card, USB drive)
config.samplers.push({
    type: "s5k",
    host: "localhost",  // Local backup
    sourcePath: "/Volumes/SD-CARD/images/",
    backupSubdir: "local-sd-card"
});

// Customize retention
config.retain.daily = 14;   // Keep 2 weeks of daily snapshots
config.retain.weekly = 8;   // Keep 2 months of weekly snapshots
config.retain.monthly = 24; // Keep 2 years of monthly snapshots

// Write to custom location
writeRsnapshotConfig(config, '~/.audiotools/rsnapshot.conf');
```

#### Manual Configuration

Edit `~/.audiotools/rsnapshot.conf` directly:

```conf
# Local media backup (SD card)
backup    /Volumes/AKAI-SD/images/    sd-card/

# Remote PiSCSI backup
backup    pi-scsi.local:/home/pi/images/    piscsi/

# Multiple samplers
backup    s5000.local:/home/pi/images/    s5000/
backup    s3000xl.local:/home/pi/images/    s3000xl/
```

